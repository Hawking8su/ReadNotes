# 关键迭代

原书链接：https://book.douban.com/subject/35434195/


## 第一部分 线上对照实验概览
### 第1章 概述和写作动机
- **一个想法的价值很难被预估。**
- 线上对照实验的术语：
	- 对照组(A)和实验组(B):
		- 对照组(A)：现有系统
		- 实验组(B)：现有系统 + X功能
	- 综合评估标准（Overall Evaluation Criterion, OEC：响应变量或因变量
	- 参数：因素或变量，通常简单的AB测试只有一个参数，两个赋值。
	- 变体：被测试的用户体验
	- 随机化单元：以伪随机化（如哈希）过程将单元映射至不同变体。推荐以用户为随机化单元。
	- 随机不代表”随意或无计划，而是一种基于概率的慎重选择“。

- 线上对照实验有以下特性：
	- 它是以高概率确立因果关系的最佳科学方法
	- 能够检测其他技术难以检测到的微小变动。
	- 能够检测到意想不到的变动。

- 有效运行对照实验的必要元素:
	1. 存在可以互不干扰的被分配至不同变体的实验单元
	2. 有足够的实验单元（如用户）
	3. 关键指标是经过一致同意的。
	4. 改动容易实现。

- **运行线上对照实验的宗旨：**
	1. 该机构想要进行数据驱动决策，且有正确的OEC。
	2. 该机构愿意为运行线上对照实验投资基础设施和测试，并确保实验结果是可信赖的。
	3. 该机构意识到其无法很好地评估想法的价值。
- 速度非常关键：
	- 每10毫秒的性能提升足以支付雇佣一个全职工程师一年的成本
- 战略、战术和实验的关系
	1. 情景1：你已有业务战略并且产品有足够的用户用于实验
		1. 公司里不仅有团队专注于如何正确的运行实验，也有团队专注于指标：选择指标、验证指标并随时间演化指标。
		2. 公司必须确立这样的指标：短期内可以被影响，并最终影响公司长期目标。
	2. 情景2：你有产品和战略，但结果显示你需要考虑调整
		1. 测试大胆的想法时，需要考虑：（1）实验的运行时长；（2）被测试的创意的数量。
		2. 信息的预期价值（Expected Value of Information, EVI）：体现了额外的信息如何帮助你做决策。

### 第2章 运行和分析实验——一个全程剖析的案例
2.1 设立实验
1. 各类改动：新功能的引入、用户界面的改动、后端的改动等

**2.2 假设检验：确立统计显著性**
1. 零假设：实验组的样本和对照组的均值相同；然后定量测量两组样本的差异的可能性大小（p值），如果可能性非常小，则我们拒绝零假设，并宣称差异是统计显著的。
2. p值：如果零假设为TRUE，则观测到两组样本差异或更极端差异的概率。
	1. p值越小，观测到当前差异的可能性越小，越统计显著 => 推翻零假设。一般p值< 0.05 判定为显著。
	2. 95%的置信区间：对应正负1.96个标准差。置信区间和p值之间存在对偶性。
	4. 注意依据实际情况，统计显著性和实际显著性的阈值可能不同。

2.3 设计实验
1. 随机化单元是什么？ 一般是用户
2. 我们的目标群体是什么？具有某一特征的用户
3. 实验需要多大的样本量？
4. 实验需要运行多久？一般至少一周

2.4 运行实验并获得数据
1. 工具化日志记录
2. 基础设置来支持实验的运行

2.5 分析结果
1. 首先做一些合理性检查来确定实验的运行是否正确
	1. 护栏指标：guardrail metric

2.6 从结果到决策
1. 运行AB测试的目标是收集数据以驱动决策。
2. 有些时候实验结果给不了清晰的答案，但依然要做出决策。


### 第3章 特威曼定律与实验的可信赖度

**数据越与众不同，越有可能是错误的。**

3.1 曲解统计结果
1. 统计功效不足
2. 曲解p值

3.2 置信区间

3.3 对内部有效性的威胁
1. 违背了个体处理稳定性假设：随机化单元（用户）之间互不影响
2. 幸存者偏差
3. 意向性分析：选择性偏差
4. 样本比率不匹配（Sample Ratio Mismatch)

3.4 对外部有效性的威胁
1. 初始效应：用户习惯了旧功能，使用新功能需要时间。该效应需要更长的测试周期。
2. 新奇效应：用户被新功能吸引并尝试。该效应无法持续。
3. 检测方法：标准的实验分析假设实验效应不随时间变化，如果发现了有变化趋势，则是一个危险的信号。

3.5 细分群的差异
1. 细分群视图有两种使用方式：
	1. 与单个实验无关，对于某个指标的细分群视图。
	2. 在某个实验背景下，对于某个指标的实验效应的细分群视图。

3.6 辛普森悖论
1. 实验组的结果在第一阶段和第二阶段好于对照组，但是把两个阶段合并时，总体差于对照组。
2. 在合并以不同百分比收集的数据时，一定要小心。

3.7 鼓励健康的怀疑态度


### 第4章 实验平台和文化

4.1 实验成熟度模型
1. 四个实验成熟阶段：
	1. 爬行：此阶段目标是确立基本的先决条件，例如日志记录和基本的数据科学功能。大约每月运行一个实验。
	2. 步行：目标是着重于定义标准指标并让机构运行更多实验。大约每周运行1个实验。
	3. 跑步：目标是规模化实验。大约每天运行1个实验。
	4. 飞行：机构将AB测试作为每次改动的标准。每年数千个实验。

4.2 基础设施和工具
**1. 实验平台的目标是普及实验使其成为自助式服务，并尽可能减少运行可信赖实验的边际成本。**
2. 规模化实验：深入研究变体分配
	1. 单层方法：两个运行中的相同实验组的分桶，假定在统计上是相似的。
		1. 每个分桶的用户量大致相同，按关键维度细分后的细分群大致相同。
		2. 关键指标的数值大致相同。
		3. 残留效应：以前实验可能会污染当前实验的结果，因此每次实验都重新随机化分桶，以使其不再连续。
	2. 并行实验：在分桶的基础上，对用户行为进行分层。
3. 实验分析：
	1. 数据清理
	2. 目标：总结并突出关键指标。
		1. 计算细分群的指标
		2. 计算p值/可信区间
		3. 进行可信度检查
		4. 将结果可视化展示。


## 第二部分 基础原理


## 相关书籍和文章：
1. The Lean Startup (Ries 2011)
2. Experiment and Testing primer (Kaushik 2006)
3. Lean Strategy (Collis 2016)
4. Georgiev 2019 -- AB实验的全面的统计解释。
5. 关于 p-value
	1. A Dirty Dozen: Twelve P-Value Misconception (Goodman 2008)
	2. What is a p-value anyway? (Vickers 2009)
6. 关于统计学
	1. Statistical Rules of Thumb(van Belle 2008)

## 问题：
1. 多臂老虎机 是什么？
2. 样本比率不匹配（Sample Ratio Mismatch) 问题 是什么？

